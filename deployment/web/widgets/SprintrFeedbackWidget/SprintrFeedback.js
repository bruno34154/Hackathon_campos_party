!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("react"));else if("function"==typeof define&&define.amd)define(["react"],t);else{var n="object"==typeof exports?t(require("react")):t(e.react);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(e){return function(e){function t(t){for(var n,a,o=t[0],c=t[1],i=0,s=[];i<o.length;i++)a=o[i],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&s.push(r[a][0]),r[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(l&&l(t);s.length;)s.shift()()}var n={},r={0:0};function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,a){n=r[e]=[t,a]}));t.push(n[2]=o);var c,i=document.createElement("script");i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.src=function(e){return a.p+"widgets/SprintrFeedbackWidget/"+e+".SprintrFeedback.js"}(e);var l=new Error;c=function(t){i.onerror=i.onload=null,clearTimeout(s);var n=r[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",l.name="ChunkLoadError",l.type=a,l.request=o,n[1](l)}r[e]=void 0}};var s=setTimeout((function(){c({type:"timeout",target:i})}),12e4);i.onerror=i.onload=c,document.head.appendChild(i)}return Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var i=0;i<o.length;i++)t(o[i]);var l=c;return a(a.s=3)}([function(t,n){t.exports=e},function(e,t,n){var r;
/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)){if(r.length){var c=a.apply(null,r);c&&e.push(c)}}else if("object"===o){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){e.push(r.toString());continue}for(var i in r)n.call(r,i)&&r[i]&&e.push(i)}}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(r=function(){return a}.apply(t,[]))||(e.exports=r)}()},function(e){e.exports=JSON.parse('{"a":"10.2.0"}')},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ue}));var r,a=n(0);!function(e){e[e.OK=200]="OK",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.SERVER_ERROR=500]="SERVER_ERROR"}(r||(r={}));var o,c,i;!function(e){e[e.Freehand=0]="Freehand"}(o||(o={})),function(e){e.MidnightBlue="#2f3646",e.Grey="#c1c3c8",e.Green="#4fd84f",e.Blue="#47a9ff",e.Purple="#845eff",e.Magenta="#ca49f8",e.Red="#fb4a4c",e.Yellow="#fcc73a"}(c||(c={})),function(e){e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e[e.Six=6]="Six"}(i||(i={}));var l=function(e){var t=e.screenshot,n=e.imageSize,r=e.setImageSize,o=e.setCursorPosition,c=e.imageCanvasRef,i=e.freehandCanvasRef,l=Object(a.useRef)(null),s=function(){c.current&&o({top:c.current.offsetTop,left:c.current.offsetLeft})};Object(a.useEffect)((function(){if(l.current&&c.current&&n){var e=c.current.getContext("2d");if(!e)return;e.drawImage(l.current,0,0,n.width,n.height),s()}}),[n]);var u=function(){if(l.current)if(l.current.width>.8*window.innerWidth){var e=.8*window.innerWidth/l.current.width;r({width:l.current.width*e,height:l.current.height*e})}else r({width:l.current.width,height:l.current.height})};return Object(a.useEffect)((function(){if(l.current&&c.current)return s(),c.current.addEventListener("resize",s),function(){c.current&&c.current.removeEventListener("resize",s)}}),[l.current,c.current]),Object(a.useEffect)((function(){return window.addEventListener("resize",u),function(){window.removeEventListener("resize",u)}}),[]),Object(a.createElement)("div",{className:"mxfeedback-annotation-canvas"},Object(a.createElement)("img",{ref:l,src:t,className:"hidden",onLoad:u}),Object(a.createElement)("canvas",{className:"mxfeedback-annotation-canvas__canvas",ref:c,width:n?n.width:void 0,height:n?n.height:void 0}),Object(a.createElement)("canvas",{className:"mxfeedback-annotation-canvas__canvas",ref:i,width:n?n.width:void 0,height:n?n.height:void 0}))},s=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg"},Object(a.createElement)("path",{d:"M3.9907 6.6554C3.77013 6.65566 3.56013 6.56093 3.41437 6.39536L0.144042 2.67803C-0.070925 2.42186 -0.0420586 2.0409 0.209075 1.82C0.460207 1.59913 0.84174 1.61913 1.06837 1.86503L3.92803 5.1157C3.94387 5.13376 3.9667 5.14413 3.9907 5.14413C4.01473 5.14413 4.03757 5.13376 4.05337 5.1157L6.91307 1.86503C7.13973 1.61913 7.52123 1.59913 7.77237 1.82C8.0235 2.0409 8.05237 2.42186 7.8374 2.67803L4.56803 6.39403C4.42203 6.56 4.21173 6.65516 3.9907 6.6554Z"}))},u=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,viewBox:"0 0 10 10",fill:"none",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Object(a.createElement)("path",{d:"M8.5 1L3.46933 8.18633C3.33468 8.37982 3.11523 8.49678 2.87953 8.50068C2.64384 8.50457 2.42064 8.39493 2.27967 8.206L1 6.5",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},d=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("rect",{x:"12",y:"14",width:"2",height:"10"}),Object(a.createElement)("rect",{x:"18",y:"14",width:"2",height:"10"}),Object(a.createElement)("rect",{x:"13",y:"3",width:"6",height:"2"}),Object(a.createElement)("path",{d:"M8,7h-3v2h2V27c0,1.1,.85,2,1.89,2h14.22c1.04,0,1.89-.9,1.89-2V9h2v-2H8Zm14.99,20H9V9h14V27Z"}))},m=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("path",{d:"M20,28H4V6h13v-2H4c-1.1,0-2,.9-2,2V28c0,1.1,.9,2,2,2H20c1.1,0,2-.9,2-2v-10h-2v10Z"}),Object(a.createElement)("path",{d:"M28.24,6.78l.03-.32c.15-1.54-.17-2.71-.95-3.49-.77-.77-1.94-1.09-3.48-.94l-.36,.04L12.09,13.48l-1.42,6.17,6.2-1.42,9.98-10.01,1.15,1.15-4.24,4.24,1.41,1.41,4.24-4.24c.38-.38,.59-.88,.59-1.41s-.21-1.04-.59-1.41l-1.17-1.17Zm-3.85-2.77c.56-.02,1.19,.05,1.53,.39,.34,.34,.41,.97,.39,1.53l-3.26,3.27-1.92-1.92,3.27-3.27Zm-8.53,12.4l-2.53,.58,.58-2.5,5.8-5.8,1.92,1.92-5.77,5.79Z"}))},b=n(1),f=n.n(b),v=[{name:"midnight",color:c.MidnightBlue},{name:"grey",color:c.Grey},{name:"green",color:c.Green},{name:"blue",color:c.Blue},{name:"purple",color:c.Purple},{name:"magenta",color:c.Magenta},{name:"red",color:c.Red},{name:"yellow",color:c.Yellow}],h=[{name:"one",width:i.One},{name:"two",width:i.Two},{name:"three",width:i.Three},{name:"four",width:i.Four},{name:"five",width:i.Five},{name:"six",width:i.Six}],p=function(e){var t=e.colorName,n=e.colorHex,r=e.setMethod,o=e.selected,c=e.freehandToolRef,i=e.tabIndex;return Object(a.createElement)("button",{className:f()("mxfeedback-tool-button__color","mxfeedback-tool-button__color--"+t),onClick:function(){var e;r(n),null===(e=c.current)||void 0===e||e.focus()},tabIndex:i},o&&Object(a.createElement)(u,null))},g=function(e){var t=e.thicknessName,n=e.width,r=e.setMethod,o=e.selected,c=e.freehandToolRef,i=e.tabIndex;return Object(a.createElement)("button",{className:f()("mxfeedback-button","mxfeedback-tool-button__thickness","mxfeedback-tool-button__thickness--"+t,o?"mxfeedback-tool-button__thickness--selected":""),onClick:function(){var e;r(n),null===(e=c.current)||void 0===e||e.focus()},tabIndex:i})},_=function(e){var t=e.menuRef,n=e.freehandToolRef,r=e.currentTool,c=e.setFreehandTool,i=e.currentColor,l=e.setCurrentColor,u=e.currentThickness,b=e.setCurrentThickness,_=e.onClearClicked,k=e.onSaveClicked,E=e.onCancel,x=e.translation,O=Object(a.useState)(!1),w=O[0],j=O[1],y=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=function(e){w&&y.current&&!y.current.contains(e.target)&&j(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[w]),Object(a.createElement)("div",{className:"mxfeedback-toolbar mxfeedback-toolbar--gap-lg mxfeedback-toolbar--annotation","data-html2canvas-ignore":"true",ref:t},Object(a.createElement)("div",{className:"mxfeedback-button-group mxfeedback-button-group--gap-md"},Object(a.createElement)("button",{className:f()("mxfeedback-tool-button",r===o.Freehand&&"mxfeedback-tool-button--active"),onClick:function(){j(!w),r!==o.Freehand&&c()},ref:n,autoFocus:!0,tabIndex:0},Object(a.createElement)("div",{className:"mxfeedback-tool-button__inner"},Object(a.createElement)(m,{className:"mxfeedback-tool-button__icon"}),Object(a.createElement)("span",{className:"mxfeedback-tool-button__label"},"Annotate")),Object(a.createElement)("div",{className:"mxfeedback-tool-button__dropdown"},Object(a.createElement)(s,{className:"mxfeedback-tool-button__caret"}),w&&Object(a.createElement)("div",{ref:y,className:"mxfeedback-tool-button__menu"},Object(a.createElement)("div",{className:"mxfeedback-tool-button__list"},v.map((function(e){return Object(a.createElement)(p,{key:e.name,colorName:e.name,colorHex:e.color,setMethod:l,selected:i===e.color,freehandToolRef:n,tabIndex:0})}))),Object(a.createElement)("div",{className:"mxfeedback-tool-button__list mxfeedback-tool-button__list--col-3"},h.map((function(e){return Object(a.createElement)(g,{key:e.name,thicknessName:e.name,setMethod:b,width:e.width,selected:u===e.width,freehandToolRef:n,tabIndex:0})})))))),Object(a.createElement)("button",{className:"mxfeedback-tool-button",onClick:_,tabIndex:0},Object(a.createElement)("div",{className:"mxfeedback-tool-button__inner"},Object(a.createElement)(d,{className:"mxfeedback-tool-button__icon"}),Object(a.createElement)("span",{className:"mxfeedback-tool-button__label"},"Clear")))),Object(a.createElement)("div",{className:"mxfeedback-button-group"},Object(a.createElement)("button",{className:f()("btn mx-button btn-secondary","mxfeedback-button mxfeedback__btn-text","mxfeedback-toolbar__cancel-screenshot-button"),type:"button",onClick:E,"data-testid":"cancel-screenshot",tabIndex:0},x.Cancel),Object(a.createElement)("button",{className:f()("btn mx-button btn-primary","mxfeedback-toolbar__save-screenshot-button mxfeedback-button"),type:"button",onClick:k,"data-testid":"save-screenshot",tabIndex:0},x.Done)))},k=function(e,t,n,r){var a;if(e&&t){var o=e.getContext("2d");if(o){e.onmousedown=function(a){if(e){var c=t.left,i=t.top;o.beginPath(),o.lineWidth=n,o.strokeStyle=r,o.lineJoin="round",o.lineCap="round",o.moveTo(a.clientX-c,a.clientY-i),e.onmouseup=function(){e&&(e.onmousemove=null,e.onmouseup=null,o.closePath())},e.onmousemove=function(e){var n=t.left,r=t.top;o.lineTo(e.clientX-n,e.clientY-r),o.stroke()}}};var c=function(e){var n=e.changedTouches;if(a&&0!==n.length){var r=t.left,c=t.top;o.beginPath(),o.moveTo(a.pageX-r,a.pageY-c),o.lineTo(n[0].pageX-r,n[0].pageY-c),o.stroke(),a=n[0]}},i=function(){e&&(e.removeEventListener("touchend",i),e.removeEventListener("touchmove",c),o.closePath())},l=function(t){e.onmousemove=null,e.onmouseup=null;var l=t.changedTouches;0!==l.length&&(a=l[0],o.beginPath(),o.lineWidth=n,o.strokeStyle=r,o.lineJoin="round",o.lineCap="round",e.addEventListener("touchend",i),e.addEventListener("touchmove",c,{passive:!0}))};e.addEventListener("touchstart",l,{passive:!0});return function(){e.removeEventListener("touchstart",l),e.removeEventListener("touchmove",c),e.removeEventListener("touchend",i)}}}},E=function(e){var t,n=e.screenshot,r=e.onSave,s=e.onCancel,u=e.translation,d=Object(a.useRef)(null),m=Object(a.useRef)(null),b=Object(a.useRef)(null),f=Object(a.useRef)(null),v=Object(a.useState)(),h=v[0],p=v[1],g=Object(a.useState)(),E=g[0],x=g[1],O=Object(a.useState)(o.Freehand),w=O[0],j=O[1],y=Object(a.useState)(c.Yellow),S=y[0],N=y[1],C=Object(a.useState)(i.Three),R=C[0],L=C[1],T=Object(a.useRef)(null),A=Object(a.useRef)(null),F=Object(a.useRef)(null);Object(a.useEffect)((function(){return b.current&&E&&(t&&t(),t=k(b.current,E,R,S)),function(){t&&t()}}),[S,R,E]);var I=function(e){var t,n;"Escape"===e.key&&s(),"Tab"===e.key&&(e.target!==F.current||e.shiftKey?e.target===A.current&&e.shiftKey&&(null===(n=F.current)||void 0===n||n.focus()):(e.preventDefault(),null===(t=A.current)||void 0===t||t.focus()))};return Object(a.useEffect)((function(){var e,t,n=Array.from(null!==(t=null===(e=T.current)||void 0===e?void 0:e.querySelectorAll("[tabindex]"))&&void 0!==t?t:[]);A.current=n[0],F.current=n[n.length-1],A.current.focus()}),[A,F]),Object(a.useEffect)((function(){return document.addEventListener("keydown",I),function(){document.removeEventListener("keydown",I)}}),[]),Object(a.createElement)("div",{ref:T,className:"mxfeedback-annotation-frame"},Object(a.createElement)(_,{menuRef:d,freehandToolRef:m,currentTool:w,setFreehandTool:function(){j(o.Freehand),b.current&&k(b.current,E,R,S)},currentColor:S,setCurrentColor:N,currentThickness:R,setCurrentThickness:L,onClearClicked:function(){if(b.current){var e=b.current.getContext("2d");e&&e.clearRect(0,0,b.current.width,b.current.height)}},onSaveClicked:function(){if(f.current){var e=f.current.getContext("2d");e&&(b.current&&e.drawImage(b.current,0,0),r(f.current.toDataURL()))}},onCancel:s,translation:u}),Object(a.createElement)(l,{screenshot:n,imageSize:h,setImageSize:p,setCursorPosition:x,imageCanvasRef:f,freehandCanvasRef:b}))},x=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("polygon",{points:"27.71 5.71 26.29 4.29 16 14.59 5.71 4.29 4.29 5.71 14.59 16 4.29 26.29 5.71 27.71 16 17.41 26.29 27.71 27.71 26.29 17.41 16 27.71 5.71"}))},O=f()("mxfeedback-failed","mxfeedback-failed__open"),w=function(e){var t=e.error,n=e.onCloseResult,r=e.translation,o=e.widgetSettings,c=Object(a.useRef)(null),i=Object(a.useRef)(null);console.error("Feedback Widget >> "+t);var l=function(e){var t,r;"Enter"!==e.key&&"Escape"!==e.key||n(),"Tab"===e.key&&(e.shiftKey?e.target===c.current&&(e.preventDefault(),null===(t=i.current)||void 0===t||t.focus()):e.target===i.current&&(e.preventDefault(),null===(r=c.current)||void 0===r||r.focus()))};return Object(a.useEffect)((function(){return document.addEventListener("keydown",l),function(){document.removeEventListener("keydown",l)}}),[]),Object(a.createElement)("div",{className:f()(O,"mxfeedback-dialog")},Object(a.createElement)("button",{ref:c,className:"mxfeedback-close-button",onClick:n,"aria-label":"Close button"},Object(a.createElement)(x,{className:"mxfeedback-close-button__icon"})),Object(a.createElement)("span",{className:"mxfeedback-dialog__title"},r.Submit_Feedback_Error_Title),Object(a.createElement)("span",{className:"mxfeedback-failed__message"},r.Submit_Feedback_Error_Message),o.submitFailedImgUrl&&Object(a.createElement)("img",{src:o.submitFailedImgUrl,alt:"failed image",className:"mxfeedback-failed__error-image"}),Object(a.createElement)("div",{className:"mxfeedback-button-group spacing-outer-top-medium"},Object(a.createElement)("button",{ref:i,className:f()("btn btn-primary","mxfeedback-failed__close-button mxfeedback-button"),form:"comment",type:"button",onClick:n,"aria-label":"Close failed button",autoFocus:!0},r.Close)))},j=function(e){return!e||!(e.length>128e3)},y=function(e){if(!e||!e.trim())return!1;if(e.length>200)return!1;return/[a-z0-9]/.test(e.toLowerCase())},S=function(e){if(!e)return!1;return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.toLowerCase())},N=function(e){if(e&&0!==e.length)if("image"===e[0].type.split("/")[0]){if(!(e[0].size>5242880))return e[0];console.error("Feedback Widget >> Image is too big")}else console.error("Feedback Widget >> File is not an image");else console.error("Feedback Widget >> No file selected")},C=function(e){var t=e.className,n=void 0===t?"":t,r=e.onClick;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",onClick:r},Object(a.createElement)("g",{strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.6"},Object(a.createElement)("path",{d:"M5 8h6"}),Object(a.createElement)("path",{d:"M8 15.5a7.5 7.5 0 100-15 7.5 7.5 0 000 15z"}),Object(a.createElement)("path",{d:"M5.879 10.121L10.12 5.88M10.121 10.121L5.878 5.88"})))},R=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("path",{d:"M16,2c-7.72,0-14,6.28-14,14s6.28,14,14,14,14-6.28,14-14S23.72,2,16,2Zm0,26c-6.62,0-12-5.38-12-12S9.38,4,16,4s12,5.38,12,12-5.38,12-12,12Z"}),Object(a.createElement)("polygon",{points:"17 13 12 13 12 15 15 15 15 22 12 22 12 24 20 24 20 22 17 22 17 13"}),Object(a.createElement)("circle",{cx:"16",cy:"9.5",r:"1.5"}))},L=function(e){var t=e.tip;return Object(a.createElement)("div",{className:"mxfeedback-tooltip"},Object(a.createElement)(R,{className:"mxfeedback-tooltip__icon"}),Object(a.createElement)("p",{className:"mxfeedback-tooltip__tip"},t))},T=function(e){var t=e.children,n=e.id,r=e.errorText,o=e.labelText,c=e.hasError,i=e.className,l=void 0===i?"":i,s=e.tooltipText,u=void 0===s?"":s;return Object(a.createElement)("div",{className:f()("form-group no-columns","mxfeedback-form-group",l,c&&"has-error"),"aria-label":"Feedback "+o},Object(a.createElement)("div",{className:"mxfeedback-label-group"},Object(a.createElement)("label",{className:"control-label mxfeedback-label-group__label",id:n+"_label"},o),u&&Object(a.createElement)(L,{tip:u})),t,c&&Object(a.createElement)("div",{className:"alert alert-danger mx-validation-message",role:"alert"},r))},A=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("path",{d:"M28.71,27.29l-6.97-6.97c1.41-1.72,2.26-3.93,2.26-6.32,0-5.51-4.49-10-10-10S4,8.49,4,14s4.49,10,10,10c2.4,0,4.6-.85,6.32-2.26l6.97,6.97,1.41-1.41Zm-14.71-5.29c-4.41,0-8-3.59-8-8S9.59,6,14,6s8,3.59,8,8-3.59,8-8,8Z"}))},F=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("path",{d:"M28,8h-5.22l-.62-2.48c-.22-.89-1.02-1.52-1.94-1.52H11.78c-.92,0-1.72,.62-1.94,1.52l-.62,2.48H4c-1.1,0-2,.9-2,2V26c0,1.1,.9,2,2,2H28c1.1,0,2-.9,2-2V10c0-1.1-.9-2-2-2Zm0,18H4V10h6.78l1-4h8.44l1,4h6.78V26Z"}),Object(a.createElement)("path",{d:"M16,12c-3.31,0-6,2.69-6,6s2.64,6,6,6,6-2.69,6-6-2.75-6-6-6Zm0,10c-2.24,0-4-1.76-4-4s1.79-4,4-4,4,1.87,4,4-1.79,4-4,4Z"}))},I=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("path",{d:"M26,26H6v-4h-2v4c0,1.1,.9,2,2,2H26c1.1,0,2-.9,2-2v-4h-2v4Z"}),Object(a.createElement)("polygon",{points:"15 7.41 15 22 17 22 17 7.41 22.29 12.71 23.71 11.29 16 3.59 8.29 11.29 9.71 12.71 15 7.41"}))},D=Object(a.forwardRef)((function(e,t){var n=e.takeScreenshot,r=e.translation,o=e.uploadScreenshot,c=Object(a.useRef)(null),i=Object(a.useRef)(null);return Object(a.createElement)("div",{className:f()("mxfeedback-button-group mxfeedback-screenshot-button-group","mxfeedback-button-group--justify-center mxfeedback-button-group--row-xs")},Object(a.createElement)("button",{className:f()("btn mx-button btn-primary mxfeedback-button","mxfeedback-button","mxfeedback-feedback-form__screenshot-button"),id:"mxfeedback_feedback_take_screenshot_button",ref:t,type:"button",onClick:n,"data-testid":"enter-screenshot-mode",tabIndex:0},Object(a.createElement)(F,null),r.Enter_screenshot_mode),Object(a.createElement)("input",{ref:c,type:"file",onChange:o,accept:".gif,.jpg,.jpeg,.png",className:"hidden"}),Object(a.createElement)("button",{tabIndex:0,className:f()("btn mx-button","mxfeedback-button","mxfeedback-feedback-form__upload-button"),id:"mxfeedback_feedback_upload_screenshot_button",ref:i,onClick:function(){var e;return c&&(null===(e=c.current)||void 0===e?void 0:e.click())},name:"feedback_attachment","data-testid":"upload-from-computer"},Object(a.createElement)(I,null),r.Upload_from_computer))}));var U,M=function(){var e=window.mx.session;return"getUserRoleNames"in e&&"function"==typeof e.getUserRoleNames?e.getUserRoleNames():[]},P=function(){var e=window.mx.ui;try{return void 0!==e&&"function"==typeof e.getContentForm&&void 0!==e.getContentForm().path?e.getContentForm():void 0}catch(e){return}},H=function(){return(H=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},B=n(2),z=function(e,t,n,r,a,o,c,i,l,s,u,d,m,b,f){return function(v){var h=v.title,p=v.description,g=v.userData,_=s.sprintrapp,k=s.feedbackServerLocation,E=j(p);e(E);var x=y(h);t(x);var O=S(g.email);n(O),O||r||a(!0),x||!o.current?E||!c.current?O||!i.current?(l(!0),function(e){var t=e.sprintrapp,n=e.feedbackServerLocation,r=e.screenshot,a=e.userId,o=e.username,c=e.email,i=e.userRoles,l=e.title,s=e.description,u=r?r.replace(/(data:image\/png;base64,)/,""):"",d=P(),m={title:l,description:s,issueType:"Issue",submitter:{userId:a,email:c,displayName:o||c},metadata:{userRoles:i.join(","),location:window.location.href,form:d?d.path:"",userAgent:navigator.userAgent,screenWidth:window.screen.width,screenHeight:window.screen.height},imageAttachment:u};if(!m.submitter.userId){if(!m.submitter.displayName)return console.warn("Feedback Widget >> Username is empty"),Promise.reject(new Error("username is empty."));if(!m.submitter.email)return console.warn("Feedback Widget >> Email address is empty"),Promise.reject(new Error("email address is empty."))}return window.fetch(n+"rest/v3/feedbackapi/projects/"+t+"/issues",{method:"POST",body:JSON.stringify(m),headers:{"Content-Type":"application/json; charset=utf-8",ClientIdentifier:"Feedback Widget v"+B.a}})}({sprintrapp:_,feedbackServerLocation:k,screenshot:s.allowScreenshot&&u?u:null,username:g?g.name:"",email:g?g.email:"",userRoles:g?g.userRoles:[],title:h,description:p}).then((function(e){e.ok?(d({title:"",description:"",email:"",screenshot:"",timestamp:""}),m(""),b()):(console.warn("Feedback Widget >> Failed submitting feedback with the following error: "+e.statusText),f(e.statusText)),l(!1)})).catch((function(e){console.warn("Feedback Widget >> Failed submitting feedback with the following error: "+e),l(!1),f(e)}))):i.current.focus():c.current.focus():o.current.focus()}},Z=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){r.result&&"string"==typeof r.result?t(r.result):n(new Error("Error reading file"))}}))},W=function(){return!(!window.navigator.clipboard||!window.navigator.clipboard.read)};!function(e){e[e.granted=0]="granted",e[e.prompt=1]="prompt",e[e.denied=2]="denied",e[e.notSupported=3]="notSupported"}(U||(U={}));var Y,q,V=function(){return(V=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},K=function(e){var t=e.widgetSettings,n=e.formData,r=e.translation,o=e.updateFormData,c=e.onUpdateScreenshot,i=e.takeScreenshot,l=e.onShowLightbox,s=e.showLightbox,u=e.cancel,d=e.succeeded,m=e.failed,b={name:"",email:n.email,userRoles:[]},v=Object(a.useState)(b),h=v[0],p=v[1],g=Object(a.useState)(!0),_=g[0],k=g[1],E=Object(a.useState)(!0),O=E[0],w=E[1],R=Object(a.useState)(!n||!n.email||S(n.email)),L=R[0],F=R[1],I=Object(a.useState)(!0),U=I[0],P=I[1],B=Object(a.useState)(!(t.userInfoEntityDS&&t.emailAddressAttribute||n&&n.email&&L)),W=B[0],Y=B[1],q=Object(a.useState)(!1),K=q[0],J=q[1],G=Object(a.useRef)(null),X=Object(a.useRef)(null),Q=Object(a.useRef)(null),$=Object(a.useRef)(null),ee=Object(a.useRef)(null),te=n.title,ne=n.description,re=n.email,ae=n.screenshot,oe=Object(a.useRef)(null),ce=Object(a.useRef)(null),ie=Object(a.useRef)(null),le=function(e,t,n,r,a){return function(o){var c=o.target.value.trim(),i=S(c);i&&e(i),t(H(H({},n),{email:c})),r(H(H({},a),{email:c,timestamp:(new Date).toString()}))}}(F,p,h,o,n),se=function(e,t,n,r,a,o,c,i,l){return function(){e||!t.current?n||!r.current?a||!o.current?!c.current||i&&l||c.current.focus():o.current.focus():r.current.focus():t.current.focus()}}(te,X,ne,Q,ae,$,ee,re,L),ue=function(e,t,n){return function(r){var a=e(r.target.files);a?(t(!0),Z(a).then(n).catch((function(e){return console.error(e)}))):t(!1)}}(N,P,c),de=z(k,w,F,W,Y,X,Q,ee,J,t,ae,o,c,d,m);!function(e,t,n){Object(a.useEffect)((function(){if(!t.userInfoEntityDS||!t.userInfoEntityDS.items||t.userInfoEntityDS.items.length<1)e(!0);else if(t.emailAddressAttribute){var r=t.emailAddressAttribute(t.userInfoEntityDS.items[0]).value||"",a=t.displayNameAttribute?t.displayNameAttribute(t.userInfoEntityDS.items[0]).value||"":r,o=M();n({name:a,email:r,userRoles:o}),e(!1)}}),[t])}(Y,t,p);var me=function(e){var t,n;"Escape"===e.key&&(s?l(!1):u()),"Tab"===e.key&&(e.shiftKey?e.target===ce.current&&(e.preventDefault(),null===(t=ie.current)||void 0===t||t.focus()):e.target===ie.current&&(e.preventDefault(),null===(n=ce.current)||void 0===n||n.focus()))};Object(a.useEffect)((function(){""!==h.email&&t.emailAddressAttribute?Y(!1):Y(!0)}),[h]),Object(a.useEffect)((function(){var e,t,n=Array.from(null!==(t=null===(e=G.current)||void 0===e?void 0:e.querySelectorAll("[tabindex]"))&&void 0!==t?t:[]);ce.current=n[0],ie.current=n[n.length-1],ce.current.focus()}),[ce,ie]),Object(a.useEffect)((function(){return document.addEventListener("keydown",me),se(),function(){document.removeEventListener("keydown",me)}}),[]);return Object(a.createElement)("div",{className:f()("mxfeedback-feedback-form","mxfeedback-dialog"),"data-html2canvas-ignore":"true",ref:G},Object(a.createElement)("button",{className:"mxfeedback-close-button",onClick:u,"aria-label":"Close button",tabIndex:0},Object(a.createElement)(x,{className:"mxfeedback-close-button__icon"})),Object(a.createElement)("div",{className:"mxfeedback-dialog__header"},Object(a.createElement)("h4",{className:"mxfeedback-dialog__title"},"Share Feedback"),Object(a.createElement)("p",{className:"mxfeedback-dialog__body-text"},"Help us make your experience better and share your feedback with us!")),Object(a.createElement)(T,{id:"mxfeedback_feedback_title",errorText:"This Field is Required",labelText:r.Subject,hasError:!O,className:"mxfeedback__input-text"},Object(a.createElement)("input",{className:"form-control",id:"mxfeedback_feedback_title_input",ref:X,type:"text",value:te,required:!0,name:"feedback_title",placeholder:"Summarize your feedback item in a few words",maxLength:200,onChange:function(e){var t=e.target.value,r=y(t);r&&w(r),o(V(V({},n),{title:t,timestamp:(new Date).toString()}))},onBlur:function(e){y(e.target.value)&&w(!0)},"aria-labelledby":"mxfeedback_feedback_title_label","data-testid":"title",autoFocus:!0,tabIndex:0})),Object(a.createElement)(T,{id:"mxfeedback_feedback_description",hasError:!_,labelText:r.Description,tooltipText:r.Add_as_many_details_as_you_can,errorText:"Comment is Invalid",className:"mxfeedback__input-textarea"},Object(a.createElement)("textarea",{className:"form-control mx-textarea-input mx-textarea-noresize",id:"mxfeedback_feedback_description_input",ref:Q,value:ne,name:"feedback_description",placeholder:"Please add a detailed description, including steps you took before finding the issue, or how this idea would help improve the experience for you and other users.",maxLength:128e3,rows:4,cols:50,onChange:function(e){k(j(e.target.value)),o(V(V({},n),{description:e.target.value,timestamp:(new Date).toString()}))},"aria-labelledby":"mxfeedback_feedback_description_label","data-testid":"description",tabIndex:0})),!!t.allowScreenshot&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(T,{id:"mxfeedback_feedback_take_screenshot",hasError:!U,labelText:r.Attachment,tooltipText:r.Use_Screenshot_mode_to_take_a_snapshot,errorText:"Maximum size is 5MB."},Object(a.createElement)(D,{takeScreenshot:i,translation:r,uploadScreenshot:ue,ref:$})),ae&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"mxfeedback-screenshot-preview"},Object(a.createElement)("img",{className:"mxfeedback-screenshot-preview__image",src:ae,alt:"Feedback screenshot image"}),Object(a.createElement)("button",{onClick:function(){return l(!0)},className:"mxfeedback-screenshot-preview__overlay",id:"mxfeedback_feedback_preview_overlay",tabIndex:0},Object(a.createElement)(A,{className:"mxfeedback-screenshot-preview__preview-icon"})),Object(a.createElement)(C,{className:"mxfeedback-screenshot-preview__delete-icon",onClick:function(){o(V(V({},n),{screenshot:"",timestamp:(new Date).toString()}))}})))),W&&Object(a.createElement)(T,{id:"mxfeedback_feedback_email",hasError:!L,labelText:r.Email_Address,tooltipText:r.Your_email_address_is_optional,errorText:"Email is Invalid",className:"mxfeedback__input-text"},Object(a.createElement)("input",{className:"form-control",id:"mxfeedback_feedback_email_input",ref:ee,type:"text",value:re,name:"comment_email",placeholder:"name@company.com",maxLength:200,onChange:le,onBlur:function(e){var t=S(n.email?n.email:e.target.value);t&&F(t)},"aria-labelledby":"mxfeedback_feedback_email_label","data-testid":"email",tabIndex:0})),Object(a.createElement)("div",{className:"mxfeedback-button-group"},Object(a.createElement)("button",{className:f()("btn mx-button btn-secondary","mxfeedback-button mxfeedback__btn-text","mxfeedback-feedback-form__cancel-button"),type:"button",onClick:u,tabIndex:0},r.Cancel),Object(a.createElement)("button",{className:"btn mx-button btn-secondary mxfeedback-button mxfeedback__btn-bordered",type:"button",onClick:function(){o({title:"",description:"",email:"",screenshot:"",timestamp:""}),c("")},tabIndex:0},"Clear"),Object(a.createElement)("button",{className:"btn mx-button btn-primary mxfeedback-button",ref:oe,"data-testid":"submit",type:"button",disabled:K,onClick:function(){K||de({title:te,description:ne,userData:h})},tabIndex:0},K?""+r.Sending_feedback:""+r.Submit)))},J=f()("mxfeedback-result","mxfeedback-result__open"),G=function(e){var t=e.onCloseResult,n=e.translation,r=e.widgetSettings,o=Object(a.useRef)(null),c=Object(a.useRef)(null),i=function(e){var n,r;"Enter"!==e.key&&"Escape"!==e.key||t(),"Tab"===e.key&&(e.shiftKey?e.target===o.current&&(e.preventDefault(),null===(n=c.current)||void 0===n||n.focus()):e.target===c.current&&(e.preventDefault(),null===(r=o.current)||void 0===r||r.focus()))};return Object(a.useEffect)((function(){return document.addEventListener("keydown",i),function(){document.removeEventListener("keydown",i)}}),[]),Object(a.createElement)("div",{className:f()(J,"mxfeedback-dialog")},Object(a.createElement)("button",{ref:o,className:"mxfeedback-close-button",onClick:t,"aria-label":"Close button"},Object(a.createElement)(x,{className:"mxfeedback-close-button__icon"})),Object(a.createElement)("span",{className:"mxfeedback-dialog__title"},n.Feedback_submitted),Object(a.createElement)("p",{className:"mxfeedback-dialog__body-text"},"Thanks for sharing your feedback with us!"),r.submitSuccessImgUrl&&Object(a.createElement)("img",{src:r.submitSuccessImgUrl,alt:"thank you image",className:"mxfeedback-result__result-image"}),Object(a.createElement)("div",{className:"mxfeedback-button-group spacing-outer-top-medium"},Object(a.createElement)("button",{ref:c,className:"btn mx-button btn-primary mxfeedback-button",form:"comment",type:"button",onClick:t,"aria-label":"Close result button",autoFocus:!0},n.Close)))},X=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function i(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}l((r=r.apply(e,t||[])).next())}))},Q=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},$=function(){return X(void 0,void 0,void 0,(function(){return Q(this,(function(e){return[2,new Promise((function(e,t){navigator.mediaDevices.getDisplayMedia({preferCurrentTab:!0}).then((function(n){(function(e){if("ImageCapture"in window){var t=e.getVideoTracks()[0],n=new ImageCapture(t);return new Promise((function(e,r){n.grabFrame().then((function(n){t.stop();var a=document.createElement("canvas");a.width=n.width,a.height=n.height;var o=a.getContext("2d");o?(o.drawImage(n,0,0,n.width,n.height),a.toBlob((function(t){return t?e(t):r(new Error("No blob"))}),"image/png")):r("No context")})).catch((function(e){return r(e)}))}))}return new Promise((function(t,n){var r=document.createElement("video"),a=document.createElement("canvas"),o=a.getContext("2d");r.srcObject=e,r.addEventListener("loadeddata",(function(){var e=r.videoWidth,c=r.videoHeight;if(a.width=e,a.height=c,o)try{o.drawImage(r,0,0,e,c),a.toBlob((function(e){r.pause(),e||n(new Error("No blob")),t(e)}),"image/png")}catch(e){n(e)}else n("No context")})),r.play()}))})(n).then((function(n){return n?e(n):t(new Error("No blob"))})).catch((function(e){return t(e)}))})).catch((function(e){return t(e)}))}))]}))}))},ee=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function i(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}l((r=r.apply(e,t||[])).next())}))},te=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},ne=function(e,t){return ee(void 0,void 0,void 0,(function(){var r,a,o,c,i,l;return te(this,(function(s){switch(s.label){case 0:return[4,ee(void 0,void 0,void 0,(function(){return te(this,(function(e){switch(e.label){case 0:return[4,n.e(1).then(n.t.bind(null,4,7))];case 1:return[2,e.sent().default]}}))}))];case 1:return r=s.sent(),a=function(e){var t=!!e&&document.querySelector(e)||document.documentElement||document.body.parentNode||document.body;return{x:t?t.scrollLeft:window.scrollX||window.pageXOffset||document.body.scrollLeft+(document.documentElement&&document.documentElement.scrollLeft||0),y:t?t.scrollTop:window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0)}}(e),o=a.x,c=a.y,[4,r(document.documentElement,{foreignObjectRendering:t,onclone:function(t){var n=t.querySelector(e)||t.body;n.scrollTop=c,n.scrollLeft=o}}).catch((function(){var e;return console.warn("\n            Feedback Widget >> An error occurred while capturing screenshot.\n            It is an known issue of a library (html2canvas) that is used in the Feedback widget.\n        "),r(document.body,{foreignObjectRendering:t,windowHeight:null===(e=document.querySelector("div.mx-page"))||void 0===e?void 0:e.clientHeight,scrollY:0})}))];case 2:return i=s.sent(),l=i.toDataURL(),i&&i.remove&&i.remove(),[2,l]}}))}))},re=function(e){var t=e.onSave,n=e.onCancel,r=e.onMinimize,o=e.scrollableAreaSelector,c=e.foreignObjectRendering,i=e.translation,l=Object(a.useState)(!1),s=l[0],u=l[1],d=Object(a.useRef)(null),m=Object(a.useRef)(null),b=Object(a.useRef)(null),v=function(){ne(o,c).then((function(e){t(e),u(!1)})).catch((function(e){console.error(e),u(!1),t("")}))},h=function(){s||(u(!0),navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia?(r(),$().then((function(e){return Z(e).then((function(e){u(!1),t(e)})).catch((function(e){console.error(e),u(!1),v()}))})).catch((function(e){console.error(e),u(!1),v()}))):v())},p=function(){W()&&new Promise((function(e,t){W()?navigator.permissions.query({name:"clipboard-read"}).then((function(n){switch(n.state){case"granted":e(U.granted);break;case"prompt":e(U.prompt);break;case"denied":e(U.denied);break;default:t(U.notSupported)}})):t(U.notSupported)})).then((function(e){e!==U.denied&&e!==U.notSupported&&new Promise((function(e,t){try{window.navigator.clipboard.read().then((function(t){for(var n=0,r=t;n<r.length;n++)for(var a=r[n],o=0,c=a.types;o<c.length;o++){var i=c[o];"image/png"===i&&a.getType(i).then((function(t){return Z(t).then((function(t){return e(t)}))}))}}))}catch(e){t(e)}})).then((function(e){t(e),u(!1)}))}))},g=function(e){var t,r;"s"!==e.key&&"S"!==e.key||h(),"v"===e.key&&(e.ctrlKey||e.metaKey)&&p(),"Escape"===e.key&&n(),"Tab"===e.key&&(e.target!==b.current||e.shiftKey?e.target===m.current&&e.shiftKey&&(null===(r=b.current)||void 0===r||r.focus()):(e.preventDefault(),null===(t=m.current)||void 0===t||t.focus()))};return Object(a.useEffect)((function(){var e,t,n=Array.from(null!==(t=null===(e=d.current)||void 0===e?void 0:e.querySelectorAll("[tabindex]"))&&void 0!==t?t:[]);m.current=n[0],b.current=n[n.length-1],m.current.focus()}),[m,b]),Object(a.useEffect)((function(){return document.addEventListener("keydown",g),function(){document.removeEventListener("keydown",g)}}),[]),Object(a.createElement)("div",{ref:d,className:"mxfeedback-toolbar mxfeedback-toolbar--screenshot","data-html2canvas-ignore":"true"},Object(a.createElement)("div",{className:"mxfeedback-button-group mxfeedback-button-group--screenshot-container"},Object(a.createElement)("button",{tabIndex:0,type:"button","data-testid":"take-screenshot",onClick:h,title:"Click to take the screenshot",className:"btn mx-button btn-primary mxfeedback-button",autoFocus:!0},Object(a.createElement)(F,{className:"mxfeedback-button__take-screenshot-icon"}),s?"Taking screenshot ...":i.Take_screenshot),Object(a.createElement)("button",{tabIndex:0,type:"button",onClick:n,className:f()("btn mx-button btn-secondary","mxfeedback-button mxfeedback__btn-text")},i.Cancel)))};!function(e){e.FORM="FORM",e.SCREENSHOT="SCREENSHOT",e.ANNOTATE="ANNOTATE",e.RESULT="RESULT",e.FAILED="FAILED",e.NULL="NULL"}(Y||(Y={})),function(e){e.UPLOAD="UPLOAD",e.CAPTURE="CAPTURE",e.THIRD_PARTY="THIRD_PARTY",e.CLIPBOARD="CLIPBOARD"}(q||(q={}));var ae=function(){return(ae=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},oe=function(e){var t=e.allowScreenshot,n=e.scrollableAreaSelector,r=e.foreignObjectRendering,o=e.userInfoEntityDS,c=e.displayNameAttribute,i=e.emailAddressAttribute,l=e.sprintrapp,s=e.feedbackServerLocation,u=e.translation,d=e.submitSuccessImgUrl,m=e.submitFailedImgUrl,b=e.stageName,f=e.setStage,v=e.setScreenshot,h=e.screenshot,p=e.onCancelAnnotationAndRemoveScreenshot,g=e.onUpdateScreenshot,_=e.setShowLightbox,k=e.showLightbox,x=e.setError,O=e.updateFormData,j=e.formData,y=e.error,S={FORM:Object(a.createElement)(K,{widgetSettings:{sprintrapp:l,feedbackServerLocation:s,allowScreenshot:t,userInfoEntityDS:o,displayNameAttribute:c,emailAddressAttribute:i},formData:j,screenshot:h,translation:u,takeScreenshot:function(){return f(Y.SCREENSHOT)},updateFormData:O,onUpdateScreenshot:g,cancel:function(){return f(Y.NULL)},succeeded:function(){return f(Y.RESULT)},failed:function(e){x(e),f(Y.FAILED)},onShowLightbox:function(){return _(!0)},showLightbox:k}),SCREENSHOT:Object(a.createElement)(re,{onSave:g,onCancel:function(){return f(Y.FORM)},onMinimize:function(){return f(Y.NULL)},foreignObjectRendering:r,scrollableAreaSelector:n,translation:u}),ANNOTATE:Object(a.createElement)(E,{screenshot:h,onSave:function(e){v(e),f(Y.FORM),O(ae(ae({},j),{screenshot:e,timestamp:(new Date).toString()}))},onCancel:p,translation:u}),RESULT:Object(a.createElement)(G,{widgetSettings:{submitSuccessImgUrl:d},onCloseResult:function(){return f(Y.NULL)},translation:u}),FAILED:Object(a.createElement)(w,{widgetSettings:{submitFailedImgUrl:m},onCloseResult:function(){return f(Y.NULL)},translation:u,error:y}),NULL:Object(a.createElement)(a.Fragment,null)};return Object(a.createElement)(a.Fragment,null,S[b])},ce=function(e){var t=e.onCloseLightbox,n=e.screenshot,r=function(e){"Escape"===e.key&&(e.stopPropagation(),t())};return Object(a.useEffect)((function(){return document.addEventListener("keydown",r),function(){document.removeEventListener("keydown",r)}}),[]),Object(a.createElement)("div",{className:"mxfeedback-lightbox"},Object(a.createElement)("button",{className:"mxfeedback-close-button mxfeedback-close-button--white",id:"mxfeedback_feedback_lightbox_close_button",onClick:t,"aria-label":"Close button",autoFocus:!0},Object(a.createElement)(x,{className:"mxfeedback-close-button__icon"})),Object(a.createElement)("img",{src:n,className:"mxfeedback-lightbox__image"}))},ie=function(e){var t=e.onClick,n=e.className,r=e.tabIndex,o=e.translation;return Object(a.createElement)("button",{"data-html2canvas-ignore":"true","data-testid":"feedback",type:"button",onClick:t,className:f()("mxfeedback-button",n),tabIndex:r},o.Feedback)},le=function(e){var t,n=(t="mxfeedback-form-data__"+e,localStorage.getItem(t)),r={title:"",description:"",email:"",screenshot:"",timestamp:""},o=Object(a.useState)(n?JSON.parse(n):r),c=o[0],i=o[1],l=function(){if(!c.timestamp)return!1;var e=new Date,t=new Date(c.timestamp.toString()).getTime();return Math.round((e.getTime()-t)/1e3)>=2678400};return Object(a.useEffect)((function(){n&&JSON.parse(n).timestamp&&l()&&i(r)}),[n,c,i,l]),Object(a.useEffect)((function(){!function(e,t){var n="string"!=typeof t?JSON.stringify(t):t;localStorage.setItem(e,n)}("mxfeedback-form-data__"+e,c)}),[c]),[c,i]},se=function(e){var t=e.className,n=e.tabIndex,r=e.allowScreenshot,o=e.scrollableAreaSelector,c=e.foreignObjectRendering,i=e.userInfoEntityDS,l=e.displayNameAttribute,s=e.emailAddressAttribute,u=e.sprintrapp,d=e.feedbackServerLocation,m=e.translation,b=e.submitSuccessImgUrl,f=e.submitFailedImgUrl,v=Object(a.useState)(Y.NULL),h=v[0],p=v[1],g=le(u),_=g[0],k=g[1],E=Object(a.useState)(""),x=E[0],O=E[1],w=Object(a.useState)(""),j=w[0],y=w[1],S=Object(a.useState)(!1),N=S[0],C=S[1];Object(a.useEffect)((function(){if(h!==Y.NULL){var e=document.querySelectorAll("[data-focus-capturing=modal]");return e.forEach((function(e){e.removeAttribute("data-focus-capturing")})),function(){e.forEach((function(e){e.setAttribute("data-focus-capturing","modal")}))}}}),[h]);return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(ie,{onClick:function(){return p(Y.FORM)},className:"mxfeedback-start-button "+t,tabIndex:n,translation:m}),N&&Object(a.createElement)(ce,{onCloseLightbox:function(){return C(!1)},screenshot:_.screenshot?_.screenshot:x}),(h===Y.FORM||h===Y.RESULT)&&Object(a.createElement)("div",{className:"mx-underlay mxfeedback-underlay","data-html2canvas-ignore":"true"}),Object(a.createElement)(oe,{allowScreenshot:r,scrollableAreaSelector:o,foreignObjectRendering:c,sprintrapp:u,userInfoEntityDS:i,displayNameAttribute:l,emailAddressAttribute:s,feedbackServerLocation:d,translation:m,submitSuccessImgUrl:b,submitFailedImgUrl:f,stageName:function(){switch(h){case Y.FORM:return"FORM";case Y.SCREENSHOT:return"SCREENSHOT";case Y.ANNOTATE:return"ANNOTATE";case Y.RESULT:return"RESULT";case Y.FAILED:return"FAILED";case Y.NULL:default:return"NULL"}}(),setStage:p,setScreenshot:O,screenshot:x,onCancelAnnotationAndRemoveScreenshot:function(){O(""),p(Y.FORM)},onUpdateScreenshot:function(e){O(e),p(e?Y.ANNOTATE:Y.FORM)},setShowLightbox:C,showLightbox:N,setError:y,updateFormData:k,formData:_,error:j}))};function ue(e){var t=e.class,n=e.tabIndex,r=e.allowScreenshot,o=e.scrollableAreaSelector,c=e.foreignObjectRendering,i=e.sprintrapp,l=e.submitSuccessImgUrl,s=e.submitFailedImgUrl,u=e.userInfoEntityDS,d=e.displayNameAttribute,m=e.emailAddressAttribute,b=e.overrideFeedbackServerLocation,f=e.translation_Feedback,v=e.translation_Close,h=e.translation_Cancel,p=e.translation_Submit,g=e.translation_Email_Address,_=e.translation_Subject,k=e.translation_Description,E=e.translation_Attachment,x=e.translation_Done,O=e.translation_Enter_screenshot_mode,w=e.translation_Upload_from_computer,j=e.translation_Summarize_feedback_item,y=e.translation_Add_as_many_details_as_you_can,S=e.translation_Use_Screenshot_mode_to_take_a_snapshot,N=e.translation_Your_email_address_is_optional,C=e.translation_Include_a_screenshot_of_the_current_page,R=e.translation_Screenshots_have_been_disabled_for_the_feedback_mode,L=e.translation_Take_screenshot,T=e.translation_Error,A=e.translation_Sending_feedback,F=e.translation_Feedback_submitted,I=e.translation_Error_creating_a_screenshot,D=e.translation_Submit_Feedback_Error_Title,U=e.translation_Submit_Feedback_Error_Message,M={Feedback:null==f?void 0:f.value,Close:null==v?void 0:v.value,Cancel:null==h?void 0:h.value,Submit:null==p?void 0:p.value,Email_Address:null==g?void 0:g.value,Subject:null==_?void 0:_.value,Description:null==k?void 0:k.value,Attachment:null==E?void 0:E.value,Done:null==x?void 0:x.value,Enter_screenshot_mode:null==O?void 0:O.value,Upload_from_computer:null==w?void 0:w.value,Summarize_feedback_item:null==j?void 0:j.value,Add_as_many_details_as_you_can:null==y?void 0:y.value,Use_Screenshot_mode_to_take_a_snapshot:null==S?void 0:S.value,Your_email_address_is_optional:null==N?void 0:N.value,Include_a_screenshot_of_the_current_page:null==C?void 0:C.value,Screenshots_have_been_disabled_for_the_feedback_mode:null==R?void 0:R.value,Take_screenshot:null==L?void 0:L.value,Error:null==T?void 0:T.value,Sending_feedback:null==A?void 0:A.value,Feedback_submitted:null==F?void 0:F.value,Error_creating_a_screenshot:null==I?void 0:I.value,Submit_Feedback_Error_Title:null==D?void 0:D.value,Submit_Feedback_Error_Message:null==U?void 0:U.value},P=b||"https://feedback-api.mendix.com/";return Object(a.createElement)(se,{className:t,tabIndex:n,allowScreenshot:r,scrollableAreaSelector:o,foreignObjectRendering:c,sprintrapp:i,userInfoEntityDS:u,displayNameAttribute:d,emailAddressAttribute:m,feedbackServerLocation:P,translation:M,submitSuccessImgUrl:l,submitFailedImgUrl:s})}}])}));